# Step 2: Update existing Terraform to deploy new secure packer image and apply user access using AAP provider

## Machine Name
```
{{ machine_url }}
```
## Ansible automation Platform

```
https://44.210.128.10
```

## Update your existing terraform configuration to use the new packer image

### copy files from aap directory to the terraform directory
<Task id="update_terraform">
```
ensure your in the terraform directory
cp ../aap/* .
ls
```
confirm the files are copied
```
root@debian:/workshop/src/working/terraform# ls
aap.tf  main.tf  terraform.auto.tfvars
root@debian:/workshop/src/working/terraform# 
```
</Task>
<Task id="update_tfvars">
update the terraform.auto.tfvars using cli, or if your more comfortable with vscode you can use that as well from the workshop tab

```
vi terraform.auto.tfvars
```
```hcl
# terraform.auto.tfvars
aap_username="#_your_team_name#_admin" replace #_your_team_name# with your team name
aap_password="" #AAP password see the docs at the top of the task page
minecraft_hostname="" #this is available in the docs at the top of the task page
minecraft_usernames=[] #update with your minecraft usernames in > ["user1","user2"]
image_source="/var/workshop/images/minecraft_vm_ansible/minecraft-vm-ansible.qcow2"
```
save the updates
```
esc :wq
```
</Task>
validate the terraform configuration updates
<Task id="validte terraform">
```
terraform init
terraform validate
```
</Task>