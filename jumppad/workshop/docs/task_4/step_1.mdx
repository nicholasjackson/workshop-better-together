# ğŸ’» Step 1:  Gaining Passage to the Final Server

ğŸ´â€â˜ ï¸ You approach Blackbeardâ€™s last citadelâ€”a shared GCP Minecraft server guarded by advanced automation.

To gain entry, you must configure Ansible Automation Platform (AAP) to execute a job to whitelist your Minecraft username, those on the access list can proceed to the puzzle-laden realm inside.

ğŸ§© Your task is to use AAP to update the existing shared GCP Minecraft serverâ€™s access list, granting you passage to the final challenge.
![finaltask](/assets/task_4/final_task.png)

Starter code has been provided in the `final` task directory. You will need to
complete this task in VS Code and apply your changes to gain access to the shared GCP Minecraft server, where the final Minecraft challenge will begin.
![vscode](/assets/task_4/task4-vscode.png)

**Note**:  The GCP Minecraft server is already running and accessible via SSH on port 22.
Its location was revealed in the previous task from Blackbeardâ€™s treasure chestâ€”refer back to your notes to find the server address.

# Complete the following tasks inside of the `final` directory:

## 1. Create a New AAP Inventory for the Shared GCP Minecraft Server

<Link href="https://registry.terraform.io/providers/ansible/aap/latest/docs/resources/inventory" target="_blank" rel="noopener noreferrer">ansible/aap/latest/docs/resources/inventory</Link>
* Hint: You will need to set the `organization` property in your configuration to your organization ID, which can be found in the provided `locals` block.


## 2. Create a new AAP host for the GCP minecraft server set any required variables
<Link href="https://registry.terraform.io/providers/ansible/aap/latest/docs/resources/host" target="_blank" rel="noopener noreferrer">ansible/aap/latest/docs/resources/host</Link>
* Hint: You will need to set the ansible_host variable to the server address retrieved from Blackbeardâ€™s treasure chest and set ansible_port to 22 for SSH access.

## 3. Execute the Job Template to update the minecraft server for access using existing job template - minecraft_whitelist
<Link href="https://registry.terraform.io/providers/ansible/aap/latest/docs/resources/job" target="_blank" rel="noopener noreferrer">ansible/aap/latest/docs/resources/job</Link>
* Hint: Credentials are preconfigured and the same as in Task 3, so no changes are needed to the AAP job template.

## 4. Update variables in the `terraform.auto.tfvars` file.


## 5. Once you have successfully completed the above tasks, verify the Ansible job execution in AAP:

* Login to the AAP web console from the tab **Ansible Automation Platform**, using `<teamname_admin>` and passwword.

* In the left menu, navigate to **Automation Execution -> Jobs**.
* Locate and review your job to check the status and output: 
    - Successful execution confirms the task was completed.
    - Vault-signed SSH certificate was injected into the execution environment and used to authenticate with the GCP Minecraft server.
    - Debug output confirms the Minecraft serverâ€™s access list was updated, granting your team access.


![aaprun](/assets/task_4/task4-aap.png)

## ğŸ” Did You Get It Right?

<Solution title="Solution">

The code you ran in task 3 `aap.tf` contains the answers you seek.

</Solution>

## Step 1 Complete ğŸ˜„

ğŸ‰ **Congratulations! Youâ€™ve now bypassed the fortress gates and stand on the threshold of the ultimate treasure hunt.**

**In Step 2, youâ€™ll face a gauntlet of puzzlesâ€”some easy, some devilishly complexâ€”but all lead to buried treasure in the Minecraft survival world.**

